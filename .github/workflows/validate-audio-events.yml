---
name: validate audio events
permissions:
  contents: read

concurrency:
  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: true

"on":
  push:
    paths:
      - "export/**"
      - "fixtures/**"
      - ".github/workflows/validate-audio-events.yml"
  pull_request:
  workflow_dispatch:

jobs:
  validate-export-events:
    name: "Validate export/audio.events.jsonl"
    uses: heimgewebe/metarepo/.github/workflows/reusable-validate-jsonl.yml@contracts-v1
    with:
      jsonl_path: export/audio.events.jsonl
      schema_url: >-
        https://raw.githubusercontent.com/heimgewebe/metarepo/contracts-v1/contracts/audio.events.schema.json
      strict: false
      validate_formats: true

  validate-fixtures-events:
    name: "Validate fixtures/audio/events.jsonl"
    uses: heimgewebe/metarepo/.github/workflows/reusable-validate-jsonl.yml@contracts-v1
    with:
      jsonl_path: fixtures/audio/events.jsonl
      schema_url: >-
        https://raw.githubusercontent.com/heimgewebe/metarepo/contracts-v1/contracts/audio.events.schema.json
      strict: false
      validate_formats: true
